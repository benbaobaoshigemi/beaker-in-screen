<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beaker In Screen - 粒子动力学模拟</title>
    <link rel="stylesheet" href="css/output.css">
    <!-- 使用本地下载的 Socket.IO 客户端，确保稳定性和版本兼容 -->
    <script src="js/socket.io.min.js"></script>
    <script type="module" src="js/main.js"></script>
</head>

<body class="bg-bg text-text-primary h-screen overflow-hidden font-sans selection:bg-border selection:text-white">

    <div class="w-full h-full max-w-app mx-auto p-md grid grid-cols-app gap-md">

        <!-- 左侧：可视化与图表 -->
        <div class="flex flex-col gap-md h-full min-h-0">
            <!-- 模拟视窗 (Space Share) -->
            <div class="relative flex-1 bg-surface rounded-panel border border-border overflow-hidden group">
                <canvas id="simulation-canvas" class="w-full h-full block"></canvas>

                <!-- 悬浮状态信息 -->
                <div
                    class="absolute top-sm left-sm bg-black/60 backdrop-blur px-sm py-xs rounded border border-white/10 text-xs text-text-muted pointer-events-none select-none">
                    FPS: <span id="stats-fps" class="text-text-primary">--</span> |
                    时间: <span id="stats-time" class="text-text-primary">0.00</span>
                </div>
            </div>

            <!-- 图表区域 (Space Share) -->
            <div class="flex-1 grid grid-cols-2 gap-md shrink-0 min-h-0">
                <!-- 浓度图 -->
                <div
                    class="bg-surface rounded-panel border border-border p-sm flex flex-col relative w-full h-full overflow-hidden">
                    <div class="flex justify-between items-center mb-xs px-xs shrink-0">
                        <h3 class="text-sm font-medium text-text-secondary">粒子数量 (Count)</h3>
                        <div id="concentration-values" class="flex gap-2 text-[10px] font-mono text-text-muted"></div>
                        <div id="concentration-legend" class="flex gap-2 text-xs"></div>
                    </div>
                    <div class="flex-1 relative w-full min-h-0">
                        <canvas id="concentration-chart" class="w-full h-full block absolute top-0 left-0"></canvas>
                    </div>
                </div>

                <!-- 速率图 -->
                <div
                    class="bg-surface rounded-panel border border-border p-sm flex flex-col relative w-full h-full overflow-hidden">
                    <div class="flex justify-between items-center mb-xs px-xs shrink-0">
                        <h3 class="text-sm font-medium text-text-secondary">反应速率</h3>
                        <div id="rate-legend" class="flex gap-1 items-center"></div>
                        <div class="flex gap-2 text-[10px] font-mono text-text-muted">
                            <span id="rate-current">速率: --</span>
                        </div>
                    </div>
                    <div class="flex-1 relative w-full min-h-0">
                        <canvas id="rate-chart" class="w-full h-full block absolute top-0 left-0"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 右侧：控制面板 -->
        <div class="bg-surface rounded-panel border border-border flex flex-col h-full overflow-hidden">
            <div class="p-md border-b border-border">
                <h1 class="text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400">
                    Beaker In Screen
                </h1>
                <p class="text-xs text-text-muted mt-1">First Principles Chemical Dynamics</p>
            </div>

            <div class="flex-1 overflow-y-auto p-md space-y-lg scrollbar-hide">

                <!-- 播放控制 -->
                <div class="flex gap-sm">
                    <button id="btn-start"
                        class="flex-1 bg-white text-black hover:bg-gray-200 py-2 rounded font-medium transition-colors text-sm active:scale-95 transform">
                        开始模拟
                    </button>
                    <button id="btn-pause"
                        class="flex-1 bg-surface-hover border border-border hover:border-text-secondary text-text-primary py-2 rounded font-medium transition-colors text-sm active:scale-95 transform">
                        暂停
                    </button>
                    <button id="btn-reset"
                        class="w-10 bg-surface-hover border border-border hover:border-red-500 hover:text-red-500 text-text-muted rounded flex items-center justify-center transition-colors active:scale-95 transform">
                        ↺
                    </button>
                </div>

                <!-- 温度控制 -->
                <div class="bg-black/20 p-sm rounded border border-border/30 space-y-sm">
                    <div class="flex justify-between text-sm">
                        <span class="text-text-secondary">系统温度 T</span>
                        <span class="font-mono text-text-primary"><span id="temp-value">300</span> K</span>
                    </div>
                    <input type="range" id="temp-slider" min="100" max="1000" value="300" step="10"
                        class="w-full h-1 bg-border rounded-lg appearance-none cursor-pointer accent-white">
                    <div class="flex justify-between text-[10px] text-text-muted">
                        <span>100K</span>
                        <span>1000K</span>
                    </div>
                </div>

                <!-- 反应配置 -->
                <div class="space-y-sm">
                    <h2
                        class="text-sm font-medium text-text-secondary uppercase tracking-wider flex items-center gap-2">
                        <span>反应方程式</span>
                        <div class="h-px flex-1 bg-border"></div>
                    </h2>

                    <div class="space-y-md">
                        <!-- 反应 1 -->
                        <div class="bg-black/30 rounded p-sm border border-border/50 space-y-xs">
                            <input type="text" id="reaction-1-eq" value="2A = B" placeholder="e.g. A + B = C"
                                class="w-full bg-transparent border-b border-border focus:border-white text-sm py-1 outline-none font-mono text-center placeholder-white/20">
                            <div class="grid grid-cols-2 gap-sm pt-2">
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] text-text-muted text-center">正向 Ea</label>
                                    <input type="number" id="reaction-1-ea-forward" value="30"
                                        class="bg-surface border border-border rounded px-2 py-1 text-xs text-center focus:border-white outline-none">
                                </div>
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] text-text-muted text-center">逆向 Ea</label>
                                    <input type="number" id="reaction-1-ea-reverse" value="30"
                                        class="bg-surface border border-border rounded px-2 py-1 text-xs text-center focus:border-white outline-none">
                                </div>
                            </div>
                        </div>

                        <!-- 反应 2 -->
                        <div
                            class="bg-black/30 rounded p-sm border border-border/50 space-y-xs opacity-80 hover:opacity-100 transition-opacity">
                            <input type="text" id="reaction-2-eq" value="" placeholder="e.g. B = C (选填)"
                                class="w-full bg-transparent border-b border-border focus:border-white text-sm py-1 outline-none font-mono text-center placeholder-white/20">
                            <div class="grid grid-cols-2 gap-sm pt-2">
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] text-text-muted text-center">正向 Ea</label>
                                    <input type="number" id="reaction-2-ea-forward" value="30"
                                        class="bg-surface border border-border rounded px-2 py-1 text-xs text-center focus:border-white outline-none">
                                </div>
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] text-text-muted text-center">逆向 Ea</label>
                                    <input type="number" id="reaction-2-ea-reverse" value="30"
                                        class="bg-surface border border-border rounded px-2 py-1 text-xs text-center focus:border-white outline-none">
                                </div>
                            </div>
                        </div>

                        <!-- 反应 3 -->
                        <div
                            class="bg-black/30 rounded p-sm border border-border/50 space-y-xs opacity-60 hover:opacity-100 transition-opacity">
                            <input type="text" id="reaction-3-eq" value="" placeholder="e.g. C = D (选填)"
                                class="w-full bg-transparent border-b border-border focus:border-white text-sm py-1 outline-none font-mono text-center placeholder-white/20">
                            <div class="grid grid-cols-2 gap-sm pt-2">
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] text-text-muted text-center">正向 Ea</label>
                                    <input type="number" id="reaction-3-ea-forward" value="30"
                                        class="bg-surface border border-border rounded px-2 py-1 text-xs text-center focus:border-white outline-none">
                                </div>
                                <div class="flex flex-col gap-1">
                                    <label class="text-[10px] text-text-muted text-center">逆向 Ea</label>
                                    <input type="number" id="reaction-3-ea-reverse" value="30"
                                        class="bg-surface border border-border rounded px-2 py-1 text-xs text-center focus:border-white outline-none">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 物质列表（动态） -->
                <div class="space-y-sm">
                    <h2
                        class="text-sm font-medium text-text-secondary uppercase tracking-wider flex items-center gap-2">
                        <span>物质属性配置</span>
                        <div class="h-px flex-1 bg-border"></div>
                    </h2>
                    <div id="substances-container" class="space-y-xs">
                        <div class="text-xs text-text-muted text-center py-4 italic">
                            正在解析反应方程...
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</body>

</html>
